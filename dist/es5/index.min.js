!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e["js-flock"]=t()}(this,function(){"use strict";var e=Object.freeze({isStrangled:!0,message:"Promise have timed out"}),t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n={freeze:Object.isFrozen,seal:Object.isSealed,preventExtensions:function(e){return!Object.isExtensible(e)}},r=function e(r,o,i){i=i||{},Object[r](o);for(var u in o){var f=o[u];!f||"object"!==(void 0===f?"undefined":t(f))&&"function"!=typeof f||n[r](f)||!i.proto&&!Object.prototype.hasOwnProperty.call(o,u)||e(r,f,i)}return o},o=function(e){return function(t,n){var r=Object.prototype.toString.call(n);if("[object "+t+"]"!==r)throw new TypeError(e+": expected ["+t+"] but got "+r+"]")}},i=function(e,t){return t={exports:{}},e(t,t.exports),t.exports}(function(e){var t=o("promisify"),n=function(e,t,n){var r=this;return new Promise(function(o,i){t.push(function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),u=1;u<t;u++)r[u-1]=arguments[u];return e?i(e):o(n&&n.multiArgs?r:r[0])}),e.apply(r,t)})},r=function(e,t,n,r,o){return"function"==typeof t[e]&&!0!==t[e].__promisified__&&(!0===o||Object.prototype.hasOwnProperty.call(t,e))&&(!r||r.some(function(t){return t===e}))&&(!n||n.every(function(t){return t!==e}))},i=function e(t,n,r){var o=""+n+r;return o in t?e(t,o,"Promisified"):o},u=function(e,r){return t("Function",e),function(){for(var t=arguments.length,o=Array(t),i=0;i<t;i++)o[i]=arguments[i];return n.call(this,e,o,r)}};u.all=function(e,n){t("Object",e);var o=n||{},f=o.suffix,c=o.exclude,a=o.include,s=o.proto;f="string"==typeof f?f:"Async",c=Array.isArray(c)?c:void 0,a=Array.isArray(a)?a:void 0;for(var y in e)if(r(y,e,c,a,s)){var l=i(e,y,f);e[l]=u(e[y],n),e[l].__promisified__=!0}return e},e.exports=u}),u=function e(t,n,r,o,i,u){var f=n(i),c=n(u);return f===c?r&&r.length>o?e(t,r[o],r,o+1,i,u):0:f<c?-t:null==f?1:null==c?-1:t},f=u.bind(null,1),c=u.bind(null,-1),a=function(e){return e},s=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a;return Array.isArray(e)?Array.isArray(n)?e.sort(t.bind(void 0,n.shift(),n,0)):e.sort(t.bind(void 0,n,void 0,0)):e},y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(e){if(Array.isArray(e)){var t={};return e.forEach(function(e){t[e]=Symbol(e)}),t}return"object"===(void 0===e?"undefined":y(e))?Object.assign({},e):{}},p=function(e,t){var n=e[t];"function"==typeof n&&(n=n.bind(e))},v=o("waitFor");return{collar:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,r=new Promise(function(t,r){return setTimeout(r,n,e)});return Promise.race([r,t])},deepFreeze:function(e,t){return r("freeze",e,t)},deepPreventExtensions:function(e,t){return r("preventExtensions",e,t)},deepSeal:function(e,t){return r("seal",e,t)},last:function(e,t){var n=Array.isArray(e)?e.length:0;if(n){if("function"!=typeof t)return e[n-1];for(;--n;)if(t(e[n]))return e[n]}},promisify:i,singular:function(e){var t=!1,n=function(){t=!1};return function(){if(!t){t=!0;for(var r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];o.unshift(n),e.apply(this,o)}}},sort:function(e){return{asc:function(t){return s(e,f,t)},desc:function(t){return s(e,c,t)}}},toEnum:function(e){var t=l(e),n=Object.keys(t).filter(function(e){return"function"!=typeof t[e]}),r=n.map(function(e){return t[e]});if(new Set(r).size!==r.length)throw new TypeError("toEnum: Duplicate values detected");Object.freeze(n),Object.freeze(r),Object.keys(t).forEach(function(e){return p(t,e)});var o={keySet:void 0,valueSet:void 0};return t.keys=function(){return n},t.values=function(){return r},t.haveKey=function(e){return o.keySet=o.keySet||new Set(n),o.keySet.has(e)},t.exists=function(e){return o.valueSet=o.valueSet||new Set(r),o.valueSet.has(e)},Object.freeze(t)},waitFor:function(e,t){v("Function",e);var n=Number(t&&t.interval)||50,r=Date.now()+(Number(t&&t.timeout)||5e3);return new Promise(function t(o,i){var u=e();return u?o(u):Date.now()>r?i(new Error("Timed out!")):setTimeout(t,n,o,i)})}}});
