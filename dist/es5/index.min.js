!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t["js-flock"]={})}(this,function(t){"use strict";var n=Object.freeze({isStrangled:!0,message:"Promise have timed out"}),e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p=function(t){return!(!t||"object"!==(void 0===t?"undefined":e(t))&&"function"!=typeof t||!Object.prototype.hasOwnProperty.call(t,"constructor")||"function"!=typeof t.constructor||!Function.prototype.toString.call(t.constructor).includes("[native code]"))},f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function r(n,o,i){var u=3<arguments.length&&void 0!==arguments[3]?arguments[3]:new Set;if(u.has(o))return o;if(i=i||{},Object[n](o),u.add(o),o===Function.prototype)return o;var t=Object.getOwnPropertyNames(o);if(Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(o))),t.forEach(function(t){var e=o[t];!e||"object"!==(void 0===e?"undefined":f(e))&&"function"!=typeof e||"undefined"==typeof ArrayBuffer||ArrayBuffer.isView(e)||"function"==typeof i.exclude&&i.exclude(t,o)||r(n,e,i,u)}),i.proto){var e=Object.getPrototypeOf(o);e&&!p(e)&&r(n,e,i,u)}return o};var o,i=function(n){return function(t,e){var r=Object.prototype.toString.call(e);if("[object "+t+"]"!==r)throw new TypeError(n+": expected ["+t+"] but got "+r+"]")}},u=(function(t){var y=i("promisify"),s=Symbol("promisified"),l=function(n,o){return y("Function",n),function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return function(t,e,u){var r=this;return new Promise(function(o,i){e.push(function(t){for(var e=arguments.length,r=Array(1<e?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return t?i(t):o(u&&u.multiArgs?r:r[0])}),t.apply(r,e)})}.call(this,n,e,o)}};l.all=function(i,u){y("Object",i);var t=u||{},f=t.suffix,c=t.exclude,a=t.include,e=t.proto;if(f="string"==typeof f?f:"Async",c=Array.isArray(c)?c:void 0,a=Array.isArray(a)?a:void 0,Object.getOwnPropertyNames(i).forEach(function(t){if(r=i[t],n=c,o=a,"function"==typeof r&&!0!==r[s]&&(!o||o.some(function(t){return t===r.name}))&&(!n||n.every(function(t){return t!==r.name}))){for(var e=""+t+f;e in i;){if(!0===i[e][s])return;e+="Promisified"}i[e]=l(i[t],u),i[e][s]=!0}var r,n,o}),e){var r=Object.getPrototypeOf(i);r&&!p(r)&&l.all(r,u)}return i},t.exports=l}(o={exports:{}},o.exports),o.exports),c=i("rerun"),a=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var u,f=t[Symbol.iterator]();!(n=(u=f.next()).done)&&(r.push(u.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&f.return&&f.return()}finally{if(o)throw i}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},y=function(t,e,r){return e===r?0:e<r?-t:null==e?1:null==r?-1:t},s=function(t){return"string"==typeof t?v:d},l=function(t,e,r,n,o,i,u){return t===e?n.length>o?s(n[o])(r,n[o],n,o+1,i,u):0:y(r,t,e)},d=function(t,e,r,n,o,i){return l(e(o),e(i),t,r,n,o,i)},v=function(t,e,r,n,o,i){return l(o[e],i[e],t,r,n,o,i)},m=function(t,e,r){if(!Array.isArray(e))return e;Array.isArray(r)&&r.length<2&&(r=a(r,1)[0]);var n=void 0;return n=r?"string"==typeof r?function(t,e,r,n){return y(t,r[e],n[e])}.bind(void 0,t,r):Array.isArray(r)?s(r[0]).bind(void 0,t,r.shift(),r,0):function(t,e,r,n){return y(t,e(r),e(n))}.bind(void 0,t,r):y.bind(void 0,t),e.sort(n)},b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h=function(t,e){var r,n=t[e];"function"!=typeof n||(r=n,/^class /.test(Function.prototype.toString.call(r)))||(t[e]=n.bind(t))},S=i("waitFor"),g={collar:function(t){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:5e3,e=new Promise(function(t,e){return setTimeout(e,r,n)});return Promise.race([e,t])},deepFreeze:function(t,e){return r("freeze",t,e)},deepPreventExtensions:function(t,e){return r("preventExtensions",t,e)},deepSeal:function(t,e){return r("seal",t,e)},empty:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return e.forEach(function(t){Array.isArray(t)&&t.splice(0,t.length)}),1===e.length?e[0]:e},last:function(t,e){var r=Array.isArray(t)?t.length:0;if(r){if("function"!=typeof e)return t[r-1];for(;--r;)if(e(t[r]))return t[r]}},promisify:u,rerun:function(t){c("Function",t);var e=0,r=void 0,n=void 0,o=void 0,i=void 0;function u(){r||i&&!i(e)||(e+=1,!1===t())?n&&n(e):setTimeout(u,o)}return{every:function(t){if(t=Number(t),c("Number",t),!(0<=t))throw Error("rerun: every() need to be called with positive number");return o=t,this},asLongAs:function(t){return c("Function",t),i=t,this},start:function(){if(void 0===o)throw Error("rerun: every() is required before calling start()");return r=!1,u(),this},stop:function(){return r=!0,this},onStop:function(t){return c("Function",t),n=t,this}}},singular:function(n){var o=!1,i=function(){return o=!1};return function(){if(!o){o=!0;for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];e.unshift(i),n.apply(this,e)}}},sort:function(e){return{asc:function(t){return m(1,e,t)},desc:function(t){return m(-1,e,t)}}},toEnum:function(t){var e=function(t){if(Array.isArray(t)){var e={};return t.forEach(function(t){e[t]=Symbol(t)}),e}return"object"===(void 0===t?"undefined":b(t))?Object.assign({},t):{}}(t),r=Object.keys(e).filter(function(t){return"function"!=typeof e[t]}),n=r.map(function(t){return e[t]});if(new Set(n).size!==n.length)throw new TypeError("toEnum: Duplicate values detected");Object.freeze(r),Object.freeze(n),Object.keys(e).forEach(function(t){return h(e,t)});var o={keySet:void 0,valueSet:void 0};return e.keys=function(){return r},e.values=function(){return n},e.haveKey=function(t){return o.keySet=o.keySet||new Set(r),o.keySet.has(t)},e.exists=function(t){return o.valueSet=o.valueSet||new Set(n),o.valueSet.has(t)},Object.freeze(e)},waitFor:function(o,t){S("Function",o);var i=Number(t&&t.interval)||50,u=Date.now()+(Number(t&&t.timeout)||5e3);return new Promise(function t(e,r){var n=o();return n?e(n):Date.now()>u?r(new Error("Timed out!")):setTimeout(t,i,e,r)})}},w=g.collar,A=g.deepFreeze,O=g.deepPreventExtensions,j=g.deepSeal,E=g.empty,x=g.last,P=g.promisify,F=g.rerun,z=g.singular,k=g.sort,T=g.toEnum,N=g.waitFor;t.default=g,t.collar=w,t.deepFreeze=A,t.deepPreventExtensions=O,t.deepSeal=j,t.empty=E,t.last=x,t.promisify=P,t.rerun=F,t.singular=z,t.sort=k,t.toEnum=T,t.waitFor=N,Object.defineProperty(t,"__esModule",{value:!0})});
