!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r(t["js-flock"]={})}(this,function(t){"use strict";var n=Object.freeze({isStrangled:!0,message:"Promise have timed out"}),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p=function(t){return!(!t||"object"!==(void 0===t?"undefined":r(t))&&"function"!=typeof t||!Object.prototype.hasOwnProperty.call(t,"constructor")||"function"!=typeof t.constructor||!Function.prototype.toString.call(t.constructor).includes("[native code]"))},f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e=function e(n,o,i){var u=3<arguments.length&&void 0!==arguments[3]?arguments[3]:new Set;if(u.has(o))return o;if(i=i||{},Object[n](o),u.add(o),o===Function.prototype)return o;var t=Object.getOwnPropertyNames(o);if(Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(o))),t.forEach(function(t){var r=o[t];!r||"object"!==(void 0===r?"undefined":f(r))&&"function"!=typeof r||"undefined"==typeof ArrayBuffer||ArrayBuffer.isView(r)||"function"==typeof i.exclude&&i.exclude(t,o)||e(n,r,i,u)}),i.proto){var r=Object.getPrototypeOf(o);r&&!p(r)&&e(n,r,i,u)}return o};var o,i=function(n){return function(t,r){var e=Object.prototype.toString.call(r);if("[object "+t+"]"!==e)throw new TypeError(n+": expected ["+t+"] but got "+e+"]")}},u=(function(t){var s=i("promisify"),y=Symbol("promisified"),l=function(n,o){return s("Function",n),function(){for(var t=arguments.length,r=Array(t),e=0;e<t;e++)r[e]=arguments[e];return function(t,r,u){var e=this;return new Promise(function(o,i){r.push(function(t){for(var r=arguments.length,e=Array(1<r?r-1:0),n=1;n<r;n++)e[n-1]=arguments[n];return t?i(t):o(u&&u.multiArgs?e:e[0])}),t.apply(e,r)})}.call(this,n,r,o)}};l.all=function(i,u){s("Object",i);var t=u||{},f=t.suffix,c=t.exclude,a=t.include,r=t.proto;if(f="string"==typeof f?f:"Async",c=Array.isArray(c)?c:void 0,a=Array.isArray(a)?a:void 0,Object.getOwnPropertyNames(i).forEach(function(t){if(e=i[t],n=c,o=a,"function"==typeof e&&!0!==e[y]&&(!o||o.some(function(t){return t===e.name}))&&(!n||n.every(function(t){return t!==e.name}))){for(var r=""+t+f;r in i;){if(!0===i[r][y])return;r+="Promisified"}i[r]=l(i[t],u),i[r][y]=!0}var e,n,o}),r){var e=Object.getPrototypeOf(i);e&&!p(e)&&l.all(e,u)}return i},t.exports=l}(o={exports:{}},o.exports),o.exports),c=i("rerun"),a=function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,r){var e=[],n=!0,o=!1,i=void 0;try{for(var u,f=t[Symbol.iterator]();!(n=(u=f.next()).done)&&(e.push(u.value),!r||e.length!==r);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&f.return&&f.return()}finally{if(o)throw i}}return e}(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")},s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y=function(t,r,e){return r===e?0:r<e?-t:null==r?1:null==e?-1:t},l=function(t,r,e,n,o,i){return m(t(o),t(i),r,e,n,o,i)},d=function(t,r,e,n,o,i){return m(o[t],i[t],r,e,n,o,i)},v=function(t,r,e,n,o,i){var u=t.asc||t.desc,f=t.asc?1:-1;if(!u)throw Error("sort: Invalid 'by' sorting onfiguration.\n      Expecting object with 'asc' or 'desc' key");return b(u)(u,r,e,f,o,i)},b=function(t){var r=void 0===t?"undefined":s(t);return"string"===r?d:"function"===r?l:v},m=function(t,r,e,n,o,i,u){return t===r||null==t&&null==r?e.length>n?b(e[n])(e[n],e,n+1,o,i,u):0:y(o,t,r)},h=function(t,r,e){if(!Array.isArray(r))return r;Array.isArray(e)&&e.length<2&&(e=a(e,1)[0]);var n=void 0;return n=e?"string"==typeof e?function(t,r,e,n){return y(t,e[r],n[r])}.bind(void 0,t,e):"function"==typeof e?function(t,r,e,n){return y(t,r(e),r(n))}.bind(void 0,t,e):b(e[0]).bind(void 0,e.shift(),e,0,t):y.bind(void 0,t),r.sort(n)},S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g=function(t,r){var e,n=t[r];"function"!=typeof n||(e=n,/^class /.test(Function.prototype.toString.call(e)))||(t[r]=n.bind(t))},w=i("waitFor"),A={collar:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:5e3,r=new Promise(function(t,r){return setTimeout(r,e,n)});return Promise.race([r,t])},deepFreeze:function(t,r){return e("freeze",t,r)},deepPreventExtensions:function(t,r){return e("preventExtensions",t,r)},deepSeal:function(t,r){return e("seal",t,r)},empty:function(){for(var t=arguments.length,r=Array(t),e=0;e<t;e++)r[e]=arguments[e];return r.forEach(function(t){Array.isArray(t)&&t.splice(0,t.length)}),1===r.length?r[0]:r},last:function(t,r){var e=Array.isArray(t)?t.length:0;if(e){if("function"!=typeof r)return t[e-1];for(;--e;)if(r(t[e]))return t[e]}},promisify:u,rerun:function(t){c("Function",t);var r=0,e=void 0,n=void 0,o=void 0,i=void 0;function u(){e||i&&!i(r)||(r+=1,!1===t())?n&&n(r):setTimeout(u,o)}return{every:function(t){if(t=Number(t),c("Number",t),!(0<=t))throw Error("rerun: every() need to be called with positive number");return o=t,this},asLongAs:function(t){return c("Function",t),i=t,this},start:function(){if(void 0===o)throw Error("rerun: every() is required before calling start()");return e=!1,u(),this},stop:function(){return e=!0,this},onStop:function(t){return c("Function",t),n=t,this}}},singular:function(n){var o=!1,i=function(){return o=!1};return function(){if(!o){o=!0;for(var t=arguments.length,r=Array(t),e=0;e<t;e++)r[e]=arguments[e];r.unshift(i),n.apply(this,r)}}},sort:function(e){return{asc:function(t){return h(1,e,t)},desc:function(t){return h(-1,e,t)},by:function(t){if(!Array.isArray(e))return e;if(!Array.isArray(t)||t.length<2)throw Error("sort: Invalid usage of 'by' sorter.\n          'by' sorter should be used only for sorting in multiple directions.\n          Did you mean to use 'asc' or 'desc' sorter instead?");var r=v.bind(void 0,t.shift(),t,0,void 0);return e.sort(r)}}},toEnum:function(t){var r=function(t){if(Array.isArray(t)){var r={};return t.forEach(function(t){r[t]=Symbol(t)}),r}return"object"===(void 0===t?"undefined":S(t))?Object.assign({},t):{}}(t),e=Object.keys(r).filter(function(t){return"function"!=typeof r[t]}),n=e.map(function(t){return r[t]});if(new Set(n).size!==n.length)throw new TypeError("toEnum: Duplicate values detected");Object.freeze(e),Object.freeze(n),Object.keys(r).forEach(function(t){return g(r,t)});var o={keySet:void 0,valueSet:void 0};return r.keys=function(){return e},r.values=function(){return n},r.haveKey=function(t){return o.keySet=o.keySet||new Set(e),o.keySet.has(t)},r.exists=function(t){return o.valueSet=o.valueSet||new Set(n),o.valueSet.has(t)},Object.freeze(r)},waitFor:function(o,t){w("Function",o);var i=Number(t&&t.interval)||50,u=Date.now()+(Number(t&&t.timeout)||5e3);return new Promise(function t(r,e){var n=o();return n?r(n):Date.now()>u?e(new Error("Timed out!")):setTimeout(t,i,r,e)})}},j=A.collar,O=A.deepFreeze,E=A.deepPreventExtensions,x=A.deepSeal,P=A.empty,F=A.last,k=A.promisify,z=A.rerun,T=A.singular,N=A.sort,D=A.toEnum,I=A.waitFor;t.default=A,t.collar=j,t.deepFreeze=O,t.deepPreventExtensions=E,t.deepSeal=x,t.empty=P,t.last=F,t.promisify=k,t.rerun=z,t.singular=T,t.sort=N,t.toEnum=D,t.waitFor=I,Object.defineProperty(t,"__esModule",{value:!0})});
